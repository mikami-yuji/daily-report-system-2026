(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,25652,e=>{"use strict";let s=(0,e.i(75254).default)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);e.s(["TrendingUp",()=>s],25652)},43432,e=>{"use strict";let s=(0,e.i(75254).default)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]);e.s(["Phone",()=>s],43432)},45423,e=>{"use strict";let s=(0,e.i(75254).default)("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]);e.s(["Bell",()=>s],45423)},73708,e=>{"use strict";let s=(0,e.i(75254).default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);e.s(["Image",()=>s],73708)},52683,e=>{"use strict";var s=e.i(43476),t=e.i(71645),l=e.i(9165),r=e.i(78138),a=e.i(78583),i=e.i(87316),d=e.i(61911),n=e.i(43432),c=e.i(25652),x=e.i(70273);let o=(0,e.i(75254).default)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);var h=e.i(73708),m=e.i(45423),p=e.i(22016),f=e.i(9694),b=e.i(75225),j=e.i(85183),g=e.i(93230),u=e.i(72526),y=e.i(34239),N=e.i(59559),v=e.i(31195);function w(){let{selectedFile:e}=(0,r.useFile)(),[w,S]=(0,t.useState)([]),[C,z]=(0,t.useState)(!0),[M,A]=(0,t.useState)(null),[B,T]=(0,t.useState)([]),[D,K]=(0,t.useState)("");(0,t.useEffect)(()=>{e&&((0,l.getReports)(e).then(e=>{S(e.sort((e,s)=>{let t=String(e.日付||"");return String(s.日付||"").localeCompare(t)})),z(!1)}).catch(e=>{console.error(e),z(!1)}),(0,l.getDesignImages)(e).then(e=>{T(e.images||[]),K(e.folder||"")}))},[e]);let I=w.filter(e=>e.上長コメント&&""!==e.上長コメント.trim()&&(!e.コメント返信欄||""===e.コメント返信欄.trim())),R=w.length,U=new Date,V=String(U.getFullYear()).slice(-2),$=String(U.getMonth()+1).padStart(2,"0"),L=`${V}/${$}`,P=w.filter(e=>e.日付&&String(e.日付).startsWith(L)).length,E=w.filter(e=>e.行動内容&&e.行動内容.includes("訪問")).length,F=w.filter(e=>e.行動内容&&e.行動内容.includes("電話")).length,Y=w.filter(e=>e.重点顧客&&"-"!==e.重点顧客&&""!==e.重点顧客),G=Y.filter(e=>e.行動内容&&e.行動内容.includes("訪問")).length,O=Y.filter(e=>e.行動内容&&e.行動内容.includes("電話")).length,X=new Set(Y.filter(e=>e.得意先CD).map(e=>e.得意先CD)).size,q=new Map;w.forEach(e=>{if(!e.日付)return;let s="",t=String(e.日付);if(t.includes("/")){let e=t.split("/");e.length>=2&&(s=`${e[0]}/${e[1]}`)}else s=t.slice(0,7);q.has(s)||q.set(s,{month:s,visits:0,calls:0,priorityVisits:0,priorityCalls:0});let l=q.get(s),r=e.重点顧客&&"-"!==e.重点顧客&&""!==e.重点顧客;e.行動内容&&e.行動内容.includes("訪問")&&(l.visits++,r&&l.priorityVisits++),e.行動内容&&e.行動内容.includes("電話")&&(l.calls++,r&&l.priorityCalls++)});let W=Array.from(q.values()).sort((e,s)=>s.month.localeCompare(e.month)),_=[...W].reverse(),H=new Map;w.forEach(e=>{let s=e.訪問先名||"名称不明";H.has(s)||H.set(s,{name:s,visits:0,calls:0,total:0});let t=H.get(s),l=!1;e.行動内容&&e.行動内容.includes("訪問")&&(t.visits++,l=!0),e.行動内容&&e.行動内容.includes("電話")&&(t.calls++,l=!0),l&&(t.total=t.visits+t.calls)});let J=Array.from(H.values()).filter(e=>e.total>0).sort((e,s)=>s.total-e.total).slice(0,10);return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex justify-between items-center",children:(0,s.jsx)("h1",{className:"text-2xl font-semibold text-sf-text",children:"ホーム"})}),I.length>0&&(0,s.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 animate-pulse-slow",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)(m.Bell,{className:"text-red-500 fill-red-500",size:24}),(0,s.jsxs)("h2",{className:"text-lg font-bold text-red-700",children:["新着コメントがあります (",I.length,"件)"]})]}),(0,s.jsx)("div",{className:"space-y-2",children:I.map(e=>(0,s.jsxs)("div",{className:"bg-white p-3 rounded border border-red-100 shadow-sm cursor-pointer hover:bg-red-50/50 transition-colors flex justify-between items-center",onClick:()=>A(e),children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"font-bold text-red-600",children:e.日付}),(0,s.jsx)("span",{className:"text-sf-text font-medium",children:e.訪問先名||"訪問先なし"}),(0,s.jsxs)("span",{className:"text-xs bg-gray-100 px-2 py-0.5 rounded text-gray-500",children:["No.",e.管理番号]})]}),(0,s.jsxs)("div",{className:"text-sm text-gray-600 mt-1 line-clamp-1",children:[(0,s.jsx)("span",{className:"font-bold mr-1",children:"上長:"}),e.上長コメント]})]}),(0,s.jsx)("button",{className:"text-xs bg-red-100 text-red-700 px-3 py-1 rounded-full font-bold hover:bg-red-200",children:"返信する"})]},e.管理番号))})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,s.jsx)(k,{title:"総日報数",value:R,icon:(0,s.jsx)(a.FileText,{className:"text-sf-light-blue"})}),(0,s.jsx)(k,{title:"今月の日報",value:P,icon:(0,s.jsx)(i.Calendar,{className:"text-green-600"})}),(0,s.jsx)(k,{title:"累計訪問件数",value:E,icon:(0,s.jsx)(d.Users,{className:"text-purple-600"})}),(0,s.jsx)(k,{title:"累計電話件数",value:F,icon:(0,s.jsx)(n.Phone,{className:"text-orange-500"})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,s.jsxs)("div",{className:"lg:col-span-2 bg-white rounded border border-sf-border shadow-sm p-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,s.jsx)(c.TrendingUp,{className:"text-sf-light-blue",size:20}),(0,s.jsx)("h2",{className:"font-semibold text-lg text-sf-text",children:"活動推移 (月別)"})]}),(0,s.jsx)("div",{style:{width:"100%",height:300},children:(0,s.jsx)(v.ResponsiveContainer,{width:"100%",height:300,children:(0,s.jsxs)(f.BarChart,{data:_,children:[(0,s.jsx)(u.CartesianGrid,{strokeDasharray:"3 3",vertical:!1}),(0,s.jsx)(j.XAxis,{dataKey:"month",tick:{fontSize:12}}),(0,s.jsx)(g.YAxis,{tick:{fontSize:12}}),(0,s.jsx)(y.Tooltip,{contentStyle:{backgroundColor:"#fff",borderRadius:"4px",border:"1px solid #ddd"},itemStyle:{fontSize:"12px"}}),(0,s.jsx)(N.Legend,{wrapperStyle:{fontSize:"12px"}}),(0,s.jsx)(b.Bar,{dataKey:"visits",name:"訪問",fill:"#8884d8",radius:[4,4,0,0]}),(0,s.jsx)(b.Bar,{dataKey:"calls",name:"電話",fill:"#82ca9d",radius:[4,4,0,0]})]})})})]}),(0,s.jsxs)("div",{className:"bg-white rounded border border-sf-border shadow-sm p-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,s.jsx)(x.Star,{className:"text-yellow-500",size:20}),(0,s.jsx)("h2",{className:"font-semibold text-lg text-sf-text",children:"重点顧客状況"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded",children:[(0,s.jsx)("span",{className:"text-sm text-sf-text-weak",children:"対象顧客数"}),(0,s.jsx)("span",{className:"text-xl font-bold text-sf-text",children:X})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded",children:[(0,s.jsx)("span",{className:"text-sm text-sf-text-weak",children:"訪問件数"}),(0,s.jsx)("span",{className:"text-xl font-bold text-purple-600",children:G})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded",children:[(0,s.jsx)("span",{className:"text-sm text-sf-text-weak",children:"電話件数"}),(0,s.jsx)("span",{className:"text-xl font-bold text-orange-600",children:O})]}),(0,s.jsxs)("div",{className:"pt-2 border-t border-sf-border",children:[(0,s.jsxs)("div",{className:"flex justify-between text-xs text-sf-text-weak mb-1",children:[(0,s.jsx)("span",{children:"活動カバー率"}),(0,s.jsxs)("span",{children:[E+F>0?Math.round((G+O)/(E+F)*100):0,"%"]})]}),(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,s.jsx)("div",{className:"bg-yellow-500 h-2 rounded-full",style:{width:`${E+F>0?Math.min(100,(G+O)/(E+F)*100):0}%`}})})]})]})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded border border-sf-border shadow-sm p-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,s.jsx)(o,{className:"text-sf-light-blue",size:20}),(0,s.jsx)("h2",{className:"font-semibold text-lg text-sf-text",children:"得意先別 活動ランキング (Top 10)"})]}),(0,s.jsx)("div",{style:{width:"100%",height:400},children:(0,s.jsx)(v.ResponsiveContainer,{width:"100%",height:400,children:(0,s.jsxs)(f.BarChart,{layout:"vertical",data:J,margin:{top:5,right:30,left:40,bottom:5},children:[(0,s.jsx)(u.CartesianGrid,{strokeDasharray:"3 3",horizontal:!0,vertical:!1}),(0,s.jsx)(j.XAxis,{type:"number",tick:{fontSize:12}}),(0,s.jsx)(g.YAxis,{dataKey:"name",type:"category",width:150,tick:{fontSize:11},interval:0}),(0,s.jsx)(y.Tooltip,{cursor:{fill:"transparent"},contentStyle:{backgroundColor:"#fff",borderRadius:"4px",border:"1px solid #ddd"},itemStyle:{fontSize:"12px"}}),(0,s.jsx)(N.Legend,{wrapperStyle:{fontSize:"12px"}}),(0,s.jsx)(b.Bar,{dataKey:"visits",name:"訪問",fill:"#8884d8",radius:[0,4,4,0],stackId:"a"}),(0,s.jsx)(b.Bar,{dataKey:"calls",name:"電話",fill:"#82ca9d",radius:[0,4,4,0],stackId:"a"})]})})})]}),(0,s.jsxs)("div",{className:"bg-white rounded border border-sf-border shadow-sm overflow-hidden",children:[(0,s.jsxs)("div",{className:"px-4 py-3 border-b border-sf-border bg-gray-50 flex items-center gap-2",children:[(0,s.jsx)(o,{size:20,className:"text-sf-light-blue"}),(0,s.jsx)("h2",{className:"font-semibold text-sm text-sf-text",children:"月別活動統計"})]}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,s.jsx)("thead",{className:"text-xs text-sf-text-weak bg-gray-50 border-b border-sf-border",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-3 font-medium",children:"月"}),(0,s.jsx)("th",{className:"px-4 py-3 font-medium text-center",children:"訪問件数"}),(0,s.jsx)("th",{className:"px-4 py-3 font-medium text-center",children:"電話件数"}),(0,s.jsx)("th",{className:"px-4 py-3 font-medium text-center",children:"合計"}),(0,s.jsx)("th",{className:"px-4 py-3 font-medium text-center border-l-2 border-yellow-200 bg-yellow-50",children:"重点顧客訪問"}),(0,s.jsx)("th",{className:"px-4 py-3 font-medium text-center bg-yellow-50",children:"重点顧客電話"}),(0,s.jsx)("th",{className:"px-4 py-3 font-medium text-center bg-yellow-50",children:"重点顧客合計"})]})}),(0,s.jsx)("tbody",{children:W.map((e,t)=>(0,s.jsxs)("tr",{className:"border-b border-sf-border hover:bg-gray-50 transition-colors",children:[(0,s.jsx)("td",{className:"px-4 py-3 font-medium text-sf-text",children:e.month}),(0,s.jsx)("td",{className:"px-4 py-3 text-center text-sf-text",children:e.visits}),(0,s.jsx)("td",{className:"px-4 py-3 text-center text-sf-text",children:e.calls}),(0,s.jsx)("td",{className:"px-4 py-3 text-center font-semibold text-sf-text",children:e.visits+e.calls}),(0,s.jsx)("td",{className:"px-4 py-3 text-center text-purple-600 border-l-2 border-yellow-200 bg-yellow-50",children:e.priorityVisits}),(0,s.jsx)("td",{className:"px-4 py-3 text-center text-orange-600 bg-yellow-50",children:e.priorityCalls}),(0,s.jsx)("td",{className:"px-4 py-3 text-center font-semibold text-yellow-700 bg-yellow-50",children:e.priorityVisits+e.priorityCalls})]},e.month))})]})})]}),(0,s.jsxs)("div",{className:"bg-white rounded border border-sf-border shadow-sm overflow-hidden",children:[(0,s.jsxs)("div",{className:"px-4 py-3 border-b border-sf-border bg-gray-50 flex justify-between items-center",children:[(0,s.jsx)("h2",{className:"font-semibold text-sm text-sf-text",children:"最近の日報"}),(0,s.jsx)("a",{href:"/reports",className:"text-sm text-sf-light-blue hover:underline",children:"すべて表示"})]}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,s.jsx)("thead",{className:"text-xs text-sf-text-weak bg-gray-50 border-b border-sf-border",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-3 font-medium",children:"日付"}),(0,s.jsx)("th",{className:"px-4 py-3 font-medium",children:"訪問先"}),(0,s.jsx)("th",{className:"px-4 py-3 font-medium",children:"行動内容"}),(0,s.jsx)("th",{className:"px-4 py-3 font-medium",children:"重点"}),(0,s.jsx)("th",{className:"px-4 py-3 font-medium",children:"面談者"})]})}),(0,s.jsx)("tbody",{children:C?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:5,className:"px-4 py-4 text-center text-sf-text-weak",children:"読み込み中..."})}):0===w.length?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:5,className:"px-4 py-4 text-center text-sf-text-weak",children:"日報が見つかりません"})}):w.slice(0,10).map((e,t)=>(0,s.jsxs)("tr",{className:"border-b border-sf-border hover:bg-gray-50 transition-colors",children:[(0,s.jsx)("td",{className:"px-4 py-3 text-sf-text",children:e.日付}),(0,s.jsx)("td",{className:"px-4 py-3 font-medium text-sf-light-blue",children:e.得意先CD?(0,s.jsx)(p.default,{href:`/customers/${e.得意先CD}`,className:"hover:underline",children:e.訪問先名}):e.訪問先名}),(0,s.jsx)("td",{className:"px-4 py-3 text-sf-text",children:e.行動内容}),(0,s.jsx)("td",{className:"px-4 py-3 text-center",children:e.重点顧客&&"-"!==e.重点顧客&&""!==e.重点顧客&&(0,s.jsx)(x.Star,{size:16,className:"text-yellow-500 inline"})}),(0,s.jsx)("td",{className:"px-4 py-3 text-sf-text",children:e.面談者})]},t))})]})})]}),(0,s.jsxs)("div",{className:"bg-white rounded border border-sf-border shadow-sm overflow-hidden",children:[(0,s.jsxs)("div",{className:"px-4 py-3 border-b border-sf-border bg-gray-50 flex items-center gap-2",children:[(0,s.jsx)(h.Image,{size:20,className:"text-pink-500"}),(0,s.jsxs)("h2",{className:"font-semibold text-sm text-sf-text",children:["デザインデータ (",D||"フォルダ検索中...",")"]})]}),(0,s.jsx)("div",{className:"p-4",children:B.length>0?(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4",children:B.map((e,t)=>(0,s.jsx)("div",{className:"group relative aspect-square bg-gray-100 rounded overflow-hidden border border-gray-200",children:(0,s.jsxs)("a",{href:(0,l.getImageUrl)(e.path),target:"_blank",rel:"noopener noreferrer",children:[(0,s.jsx)("img",{src:(0,l.getImageUrl)(e.path),alt:e.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",loading:"lazy"}),(0,s.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-xs p-1 truncate opacity-0 group-hover:opacity-100 transition-opacity",children:e.name})]})},t))}):(0,s.jsx)("div",{className:"text-center py-8 text-gray-500",children:D?"画像が見つかりませんでした":"関連するデザインデータフォルダが見つかりません"})})]})]})}function k({title:e,value:t,icon:l}){return(0,s.jsxs)("div",{className:"bg-white p-4 rounded border border-sf-border shadow-sm flex items-start justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-sf-text-weak mb-1",children:e}),(0,s.jsx)("p",{className:"text-2xl font-semibold text-sf-text",children:t})]}),(0,s.jsx)("div",{className:"p-2 bg-gray-50 rounded-full border border-gray-200",children:l})]})}e.s(["default",()=>w],52683)}]);