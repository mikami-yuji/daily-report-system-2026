(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,84614,e=>{"use strict";let s=(0,e.i(75254).default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);e.s(["User",()=>s],84614)},46897,e=>{"use strict";let s=(0,e.i(75254).default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);e.s(["MapPin",()=>s],46897)},25652,e=>{"use strict";let s=(0,e.i(75254).default)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);e.s(["TrendingUp",()=>s],25652)},43432,e=>{"use strict";let s=(0,e.i(75254).default)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]);e.s(["Phone",()=>s],43432)},52008,e=>{"use strict";let s=(0,e.i(75254).default)("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]);e.s(["Layers",()=>s],52008)},19624,e=>{"use strict";var s=e.i(43476),t=e.i(71645),r=e.i(9165),l=e.i(78138),a=e.i(84614),i=e.i(46897),d=e.i(87316),n=e.i(43432),x=e.i(78583),c=e.i(88844),o=e.i(52008),m=e.i(25652),p=e.i(75254);let h=(0,p.default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),g=(0,p.default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var b=e.i(78894),f=e.i(22016),u=e.i(18566);function j(){let{selectedFile:e}=(0,l.useFile)(),p=(0,u.useSearchParams)().get("code"),[j,N]=(0,t.useState)([]),[v,y]=(0,t.useState)(!0),[w,k]=(0,t.useState)(""),[S,z]=(0,t.useState)("timeline"),[U,C]=(0,t.useState)([]),[P,T]=(0,t.useState)("");(0,t.useEffect)(()=>{p&&e&&(0,r.getReports)(e).then(e=>{let s=e.filter(e=>String(e.得意先CD)===p);s.sort((e,s)=>{let t=String(e.日付||"");return String(s.日付||"").localeCompare(t)}),N(s),s.length>0&&k(s[0].訪問先名||"名称不明"),A(s),y(!1)}).catch(e=>{console.error(e),y(!1)})},[p,e]);let A=e=>{let s=new Map;e.forEach(e=>{let t=e["システム確認用デザインNo."];if(t&&!isNaN(Number(t))){let r=Number(t);s.has(r)||s.set(r,{designNo:r,designProposal:String(e["デザイン提案有無"]||""),designType:String(e["デザイン種別"]||""),designName:String(e["デザイン名"]||""),designProgress:String(e["デザイン進捗状況"]||""),requests:[],lastUpdate:""}),s.get(r).requests.push(e)}});let t=Array.from(s.values()).map(e=>(e.requests.sort((e,s)=>{let t=String(e.日付||"");return String(s.日付||"").localeCompare(t)}),e.lastUpdate=e.requests[0]?.日付||"",e));t.sort((e,s)=>s.lastUpdate.localeCompare(e.lastUpdate)),C(t)},M=Array.from(new Set(j.map(e=>e.面談者).filter(Boolean))).sort(),q=P?j.filter(e=>e.面談者===P):j,[B,L]=(0,t.useState)(""),[$,R]=(0,t.useState)(""),D=Array.from(new Set(U.map(e=>e.designType).filter(Boolean))).sort(),E=Array.from(new Set(U.map(e=>e.designProgress).filter(Boolean))).sort(),F=U.filter(e=>{let s=!B||e.designType===B,t=!$||e.designProgress===$;return s&&t});return v?(0,s.jsx)("div",{className:"p-8 text-center text-sf-text-weak",children:"読み込み中..."}):0===j.length?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)(f.default,{href:"/customers",className:"inline-flex items-center text-sf-light-blue hover:underline mb-4",children:[(0,s.jsx)(g,{size:16,className:"mr-1"}),"得意先一覧に戻る"]}),(0,s.jsx)("div",{className:"bg-white p-8 rounded border border-sf-border text-center",children:(0,s.jsx)("p",{className:"text-sf-text-weak",children:"指定された得意先のデータが見つかりません。"})})]}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-white rounded border border-sf-border shadow-sm p-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sf-text-weak text-sm mb-2",children:[(0,s.jsx)(f.default,{href:"/customers",className:"hover:text-sf-light-blue hover:underline",children:"得意先一覧"}),(0,s.jsx)("span",{children:"/"}),(0,s.jsx)("span",{children:w})]}),(0,s.jsx)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-2xl font-bold text-sf-text flex items-center gap-3",children:[w,(0,s.jsxs)("span",{className:"text-base font-normal text-sf-text-weak bg-gray-100 px-2 py-1 rounded",children:["CD: ",p]}),j.length>0&&j[0].重点顧客&&"-"!==j[0].重点顧客&&""!==j[0].重点顧客&&(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-1 rounded text-sm font-medium bg-yellow-100 text-yellow-800",children:"★ 重点顧客"})]}),j.length>0&&(0,s.jsxs)("div",{className:"flex items-center gap-4 mt-2 text-sm text-sf-text-weak",children:[j[0].ランク&&(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(m.TrendingUp,{size:14}),(0,s.jsxs)("span",{children:["ランク: ",j[0].ランク]})]}),j[0].エリア&&(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(i.MapPin,{size:14}),(0,s.jsxs)("span",{children:["エリア: ",j[0].エリア]})]})]})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-7 gap-4",children:[(0,s.jsxs)("div",{className:"text-center px-4 py-3 bg-gray-50 rounded border border-sf-border",children:[(0,s.jsx)("p",{className:"text-xs text-sf-text-weak mb-1",children:"総活動数"}),(0,s.jsx)("p",{className:"text-2xl font-semibold text-sf-text",children:j.length})]}),(0,s.jsxs)("div",{className:"text-center px-4 py-3 bg-green-50 rounded border border-green-200",children:[(0,s.jsx)("p",{className:"text-xs text-green-700 mb-1",children:"訪問"}),(0,s.jsx)("p",{className:"text-2xl font-semibold text-green-600",children:j.filter(e=>e.行動内容&&e.行動内容.includes("訪問")).length})]}),(0,s.jsxs)("div",{className:"text-center px-4 py-3 bg-blue-50 rounded border border-blue-200",children:[(0,s.jsx)("p",{className:"text-xs text-blue-700 mb-1",children:"電話"}),(0,s.jsx)("p",{className:"text-2xl font-semibold text-blue-600",children:j.filter(e=>e.行動内容&&e.行動内容.includes("電話")).length})]}),(0,s.jsxs)("div",{className:"text-center px-4 py-3 bg-purple-50 rounded border border-purple-200",children:[(0,s.jsx)("p",{className:"text-xs text-purple-700 mb-1",children:"デザイン案件"}),(0,s.jsx)("p",{className:"text-2xl font-semibold text-purple-600",children:U.length})]}),(0,s.jsxs)("div",{className:"text-center px-4 py-3 bg-red-50 rounded border border-red-200",children:[(0,s.jsx)("p",{className:"text-xs text-red-700 mb-1",children:"クレーム"}),(0,s.jsx)("p",{className:"text-2xl font-semibold text-red-600",children:j.filter(e=>e.行動内容&&e.行動内容.includes("クレーム")||e.商談内容&&String(e.商談内容).includes("クレーム")).length})]}),(0,s.jsxs)("div",{className:"text-center px-4 py-3 bg-orange-50 rounded border border-orange-200",children:[(0,s.jsx)("p",{className:"text-xs text-orange-700 mb-1",children:"提案物"}),(0,s.jsx)("p",{className:"text-2xl font-semibold text-orange-600",children:j.filter(e=>e.提案物&&"string"==typeof e.提案物&&""!==e.提案物.trim()).length})]}),(0,s.jsxs)("div",{className:"text-center px-4 py-3 bg-gray-50 rounded border border-sf-border",children:[(0,s.jsx)("p",{className:"text-xs text-sf-text-weak mb-1",children:"最終活動"}),(0,s.jsx)("p",{className:"text-sm font-semibold text-sf-text",children:j.length>0?j[0].日付:"-"})]})]})]}),(0,s.jsx)("div",{className:"border-b border-sf-border",children:(0,s.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,s.jsxs)("button",{onClick:()=>z("timeline"),className:`
              whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2
              ${"timeline"===S?"border-sf-light-blue text-sf-light-blue":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}
            `,children:[(0,s.jsx)(h,{size:18}),"活動履歴（タイムライン）"]}),(0,s.jsxs)("button",{onClick:()=>z("designs"),className:`
              whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2
              ${"designs"===S?"border-sf-light-blue text-sf-light-blue":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}
            `,children:[(0,s.jsx)(c.Package,{size:18}),"デザイン案件",(0,s.jsx)("span",{className:"bg-gray-100 text-gray-600 py-0.5 px-2 rounded-full text-xs ml-1",children:U.length})]}),(0,s.jsxs)("button",{onClick:()=>z("complaints"),className:`
              whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2
              ${"complaints"===S?"border-sf-light-blue text-sf-light-blue":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}
            `,children:[(0,s.jsx)(b.AlertTriangle,{size:18}),"クレーム対応",(0,s.jsx)("span",{className:"bg-gray-100 text-gray-600 py-0.5 px-2 rounded-full text-xs ml-1",children:j.filter(e=>e.行動内容&&e.行動内容.includes("クレーム")||e.商談内容&&String(e.商談内容).includes("クレーム")).length})]})]})}),(0,s.jsxs)("div",{className:"min-h-[400px]",children:["timeline"===S&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"flex justify-end mb-4",children:(0,s.jsxs)("div",{className:"relative w-64",children:[(0,s.jsx)(a.User,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),(0,s.jsxs)("select",{value:P,onChange:e=>T(e.target.value),className:"w-full pl-9 pr-4 py-2 text-sm border border-sf-border rounded focus:outline-none focus:ring-2 focus:ring-sf-light-blue focus:border-transparent appearance-none bg-white",children:[(0,s.jsx)("option",{value:"",children:"すべての面談者"}),M.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})]})}),0===q.length?(0,s.jsx)("div",{className:"text-center py-12 text-sf-text-weak bg-white rounded border border-sf-border",children:P?"該当する面談者の活動履歴はありません":"活動履歴はありません"}):q.map((e,t)=>{var r;return(0,s.jsxs)("div",{className:"bg-white p-4 rounded border border-sf-border shadow-sm hover:shadow-md transition-shadow relative pl-12",children:[(0,s.jsxs)("div",{className:"absolute left-4 top-4 flex flex-col items-center h-full",children:[(0,s.jsx)("div",{className:"bg-gray-100 p-1.5 rounded-full border border-sf-border z-10",children:(r=e.行動内容).includes("電話")?(0,s.jsx)(n.Phone,{size:16,className:"text-blue-500"}):r.includes("訪問")?(0,s.jsx)(a.User,{size:16,className:"text-green-500"}):(0,s.jsx)(x.FileText,{size:16,className:"text-gray-500"})}),t!==q.length-1&&(0,s.jsx)("div",{className:"w-px bg-gray-200 h-full absolute top-8"})]}),(0,s.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-semibold text-sf-text mr-2",children:e.日付}),(0,s.jsx)("span",{className:"text-sm text-sf-text-weak bg-gray-100 px-2 py-0.5 rounded",children:e.行動内容})]}),e.面談者&&(0,s.jsxs)("div",{className:"flex items-center text-sm text-sf-text-weak",children:[(0,s.jsx)(a.User,{size:14,className:"mr-1"}),e.面談者]})]}),(0,s.jsx)("div",{className:"text-sf-text text-sm leading-relaxed whitespace-pre-wrap",children:e.商談内容||(0,s.jsx)("span",{className:"text-gray-400 italic",children:"商談内容の記録なし"})}),(e.提案物||e.次回プラン)&&(0,s.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-100 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.提案物&&(0,s.jsxs)("div",{className:"text-xs",children:[(0,s.jsx)("span",{className:"font-medium text-sf-text-weak block mb-1",children:"提案物"}),(0,s.jsx)("span",{className:"text-sf-text",children:e.提案物})]}),e.次回プラン&&(0,s.jsxs)("div",{className:"text-xs",children:[(0,s.jsx)("span",{className:"font-medium text-sf-text-weak block mb-1",children:"次回プラン"}),(0,s.jsx)("span",{className:"text-sf-text",children:e.次回プラン})]})]}),e["システム確認用デザインNo."]&&(0,s.jsx)("div",{className:"mt-3",children:(0,s.jsxs)("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-sf-light-blue bg-blue-50 px-2 py-1 rounded border border-blue-100",children:[(0,s.jsx)(c.Package,{size:12}),"デザインNo. ",e["システム確認用デザインNo."]]})})]},t)})]}),"designs"===S&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex justify-end gap-4 mb-4",children:[(0,s.jsxs)("div",{className:"relative w-48",children:[(0,s.jsx)(o.Layers,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),(0,s.jsxs)("select",{value:B,onChange:e=>L(e.target.value),className:"w-full pl-9 pr-4 py-2 text-sm border border-sf-border rounded focus:outline-none focus:ring-2 focus:ring-sf-light-blue focus:border-transparent appearance-none bg-white",children:[(0,s.jsx)("option",{value:"",children:"すべての種別"}),D.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})]}),(0,s.jsxs)("div",{className:"relative w-48",children:[(0,s.jsx)(m.TrendingUp,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),(0,s.jsxs)("select",{value:$,onChange:e=>R(e.target.value),className:"w-full pl-9 pr-4 py-2 text-sm border border-sf-border rounded focus:outline-none focus:ring-2 focus:ring-sf-light-blue focus:border-transparent appearance-none bg-white",children:[(0,s.jsx)("option",{value:"",children:"すべての進捗"}),E.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})]})]}),0===F.length?(0,s.jsx)("div",{className:"text-center py-12 text-sf-text-weak bg-white rounded border border-sf-border",children:B||$?"該当するデザイン案件はありません":"デザイン案件はありません"}):(0,s.jsx)("div",{className:"grid grid-cols-1 gap-6",children:F.map(e=>{var t;let r;return(0,s.jsxs)("div",{className:"bg-white rounded border border-sf-border shadow-sm overflow-hidden",children:[(0,s.jsxs)("div",{className:"p-4 border-b border-sf-border bg-gray-50 flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("span",{className:"font-bold text-lg text-sf-light-blue",children:["#",e.designNo]}),(0,s.jsx)("h3",{className:"font-semibold text-sf-text",children:e.designName||"名称未設定"})]}),(r=({完了:"bg-green-100 text-green-800",進行中:"bg-blue-100 text-blue-800",保留:"bg-yellow-100 text-yellow-800",未着手:"bg-gray-100 text-gray-800"})[t=e.designProgress]||"bg-gray-100 text-gray-800",(0,s.jsx)("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${r}`,children:t||"未設定"}))]}),(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsx)(o.Layers,{size:16,className:"text-purple-600 mt-0.5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-sf-text-weak",children:"種別"}),(0,s.jsx)("p",{className:"text-sm font-medium text-sf-text",children:e.designType||"-"})]})]}),(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsx)(m.TrendingUp,{size:16,className:"text-green-600 mt-0.5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-sf-text-weak",children:"提案有無"}),(0,s.jsx)("p",{className:"text-sm font-medium text-sf-text",children:e.designProposal||"-"})]})]}),(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsx)(d.Calendar,{size:16,className:"text-orange-500 mt-0.5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-sf-text-weak",children:"最終更新"}),(0,s.jsx)("p",{className:"text-sm font-medium text-sf-text",children:e.lastUpdate})]})]})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("h4",{className:"text-xs font-semibold text-sf-text-weak uppercase tracking-wider border-b border-gray-100 pb-1",children:["関連する活動履歴 (",e.requests.length,"件)"]}),e.requests.map((e,t)=>(0,s.jsxs)("div",{className:"text-sm border-l-2 border-gray-200 pl-3 py-1 hover:border-sf-light-blue transition-colors",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)("span",{className:"text-xs font-medium text-sf-text",children:e.日付}),(0,s.jsx)("span",{className:"text-xs text-sf-text-weak bg-gray-100 px-1.5 rounded",children:e.行動内容})]}),(0,s.jsx)("p",{className:"text-sf-text line-clamp-2",children:e.商談内容})]},t))]})]})]},e.designNo)})})]}),"complaints"===S&&(0,s.jsx)("div",{className:"space-y-4",children:0===j.filter(e=>e.行動内容&&e.行動内容.includes("クレーム")||e.商談内容&&String(e.商談内容).includes("クレーム")).length?(0,s.jsx)("div",{className:"text-center py-12 text-sf-text-weak bg-white rounded border border-sf-border",children:"クレーム対応履歴はありません"}):j.filter(e=>e.行動内容&&e.行動内容.includes("クレーム")||e.商談内容&&String(e.商談内容).includes("クレーム")).map((e,t)=>(0,s.jsxs)("div",{className:"bg-white p-4 rounded border border-sf-border shadow-sm hover:shadow-md transition-shadow relative pl-12",children:[(0,s.jsxs)("div",{className:"absolute left-4 top-4 flex flex-col items-center h-full",children:[(0,s.jsx)("div",{className:"bg-orange-100 p-1.5 rounded-full border border-orange-200 z-10",children:(0,s.jsx)(b.AlertTriangle,{size:16,className:"text-orange-600"})}),t!==j.filter(e=>e.行動内容&&e.行動内容.includes("クレーム")||e.商談内容&&String(e.商談内容).includes("クレーム")).length-1&&(0,s.jsx)("div",{className:"w-px bg-gray-200 h-full absolute top-8"})]}),(0,s.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"font-semibold text-sf-text",children:e.日付}),(0,s.jsx)("span",{className:"text-sm text-orange-700 bg-orange-100 px-2 py-0.5 rounded font-medium",children:e.行動内容||"-"})]}),e.面談者&&(0,s.jsxs)("div",{className:"flex items-center text-sm text-sf-text-weak",children:[(0,s.jsx)(a.User,{size:14,className:"mr-1"}),e.面談者]})]}),e.商談内容&&(0,s.jsxs)("div",{className:"bg-orange-50 border border-orange-200 rounded p-3",children:[(0,s.jsx)("p",{className:"text-xs font-semibold text-orange-800 mb-1",children:"対応内容"}),(0,s.jsx)("p",{className:"text-sm text-sf-text whitespace-pre-wrap",children:e.商談内容})]}),e.次回プラン&&(0,s.jsxs)("div",{className:"mt-3 text-sm text-sf-text-weak",children:[(0,s.jsx)("span",{className:"font-medium",children:"次回プラン: "}),(0,s.jsx)("span",{className:"text-sf-text",children:e.次回プラン})]})]},t))})]})]})}function N(){return(0,s.jsx)(t.Suspense,{fallback:(0,s.jsx)("div",{className:"p-8 text-center text-sf-text-weak",children:"読み込み中..."}),children:(0,s.jsx)(j,{})})}e.s(["default",()=>N],19624)}]);