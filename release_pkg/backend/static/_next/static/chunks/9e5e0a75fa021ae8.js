(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,54928,e=>{"use strict";let t;var s=e.i(75555),r=e.i(40143),i=e.i(86491),a=e.i(15823),n=e.i(93803),l=e.i(19273),c=e.i(80166),o=class extends a.Subscribable{constructor(e,t){super(),this.options=t,this.#e=e,this.#t=null,this.#s=(0,n.pendingThenable)(),this.bindMethods(),this.setOptions(t)}#e;#r=void 0;#i=void 0;#a=void 0;#n;#l;#s;#t;#c;#o;#d;#u;#h;#p;#x=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#r.addObserver(this),d(this.#r,this.options)?this.#m():this.updateResult(),this.#f())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return u(this.#r,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return u(this.#r,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#y(),this.#b(),this.#r.removeObserver(this)}setOptions(e){let t=this.options,s=this.#r;if(this.options=this.#e.defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof(0,l.resolveEnabled)(this.options.enabled,this.#r))throw Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#g(),this.#r.setOptions(this.options),t._defaulted&&!(0,l.shallowEqualObjects)(this.options,t)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#r,observer:this});let r=this.hasListeners();r&&h(this.#r,s,this.options,t)&&this.#m(),this.updateResult(),r&&(this.#r!==s||(0,l.resolveEnabled)(this.options.enabled,this.#r)!==(0,l.resolveEnabled)(t.enabled,this.#r)||(0,l.resolveStaleTime)(this.options.staleTime,this.#r)!==(0,l.resolveStaleTime)(t.staleTime,this.#r))&&this.#v();let i=this.#j();r&&(this.#r!==s||(0,l.resolveEnabled)(this.options.enabled,this.#r)!==(0,l.resolveEnabled)(t.enabled,this.#r)||i!==this.#p)&&this.#N(i)}getOptimisticResult(e){var t,s;let r=this.#e.getQueryCache().build(this.#e,e),i=this.createResult(r,e);return t=this,s=i,(0,l.shallowEqualObjects)(t.getCurrentResult(),s)||(this.#a=i,this.#l=this.options,this.#n=this.#r.state),i}getCurrentResult(){return this.#a}trackResult(e,t){return new Proxy(e,{get:(e,s)=>(this.trackProp(s),t?.(s),"promise"===s&&(this.trackProp("data"),this.options.experimental_prefetchInRender||"pending"!==this.#s.status||this.#s.reject(Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(e,s))})}trackProp(e){this.#x.add(e)}getCurrentQuery(){return this.#r}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){let t=this.#e.defaultQueryOptions(e),s=this.#e.getQueryCache().build(this.#e,t);return s.fetch().then(()=>this.createResult(s,t))}fetch(e){return this.#m({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#a))}#m(e){this.#g();let t=this.#r.fetch(this.options,e);return e?.throwOnError||(t=t.catch(l.noop)),t}#v(){this.#y();let e=(0,l.resolveStaleTime)(this.options.staleTime,this.#r);if(l.isServer||this.#a.isStale||!(0,l.isValidTimeout)(e))return;let t=(0,l.timeUntilStale)(this.#a.dataUpdatedAt,e);this.#u=c.timeoutManager.setTimeout(()=>{this.#a.isStale||this.updateResult()},t+1)}#j(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#r):this.options.refetchInterval)??!1}#N(e){this.#b(),this.#p=e,!l.isServer&&!1!==(0,l.resolveEnabled)(this.options.enabled,this.#r)&&(0,l.isValidTimeout)(this.#p)&&0!==this.#p&&(this.#h=c.timeoutManager.setInterval(()=>{(this.options.refetchIntervalInBackground||s.focusManager.isFocused())&&this.#m()},this.#p))}#f(){this.#v(),this.#N(this.#j())}#y(){this.#u&&(c.timeoutManager.clearTimeout(this.#u),this.#u=void 0)}#b(){this.#h&&(c.timeoutManager.clearInterval(this.#h),this.#h=void 0)}createResult(e,t){let s,r=this.#r,a=this.options,c=this.#a,o=this.#n,u=this.#l,x=e!==r?e.state:this.#i,{state:m}=e,f={...m},y=!1;if(t._optimisticResults){let s=this.hasListeners(),n=!s&&d(e,t),l=s&&h(e,r,t,a);(n||l)&&(f={...f,...(0,i.fetchState)(m.data,e.options)}),"isRestoring"===t._optimisticResults&&(f.fetchStatus="idle")}let{error:b,errorUpdatedAt:g,status:v}=f;s=f.data;let j=!1;if(void 0!==t.placeholderData&&void 0===s&&"pending"===v){let e;c?.isPlaceholderData&&t.placeholderData===u?.placeholderData?(e=c.data,j=!0):e="function"==typeof t.placeholderData?t.placeholderData(this.#d?.state.data,this.#d):t.placeholderData,void 0!==e&&(v="success",s=(0,l.replaceData)(c?.data,e,t),y=!0)}if(t.select&&void 0!==s&&!j)if(c&&s===o?.data&&t.select===this.#c)s=this.#o;else try{this.#c=t.select,s=t.select(s),s=(0,l.replaceData)(c?.data,s,t),this.#o=s,this.#t=null}catch(e){this.#t=e}this.#t&&(b=this.#t,s=this.#o,g=Date.now(),v="error");let N="fetching"===f.fetchStatus,R="pending"===v,w="error"===v,S=R&&N,C=void 0!==s,I={status:v,fetchStatus:f.fetchStatus,isPending:R,isSuccess:"success"===v,isError:w,isInitialLoading:S,isLoading:S,data:s,dataUpdatedAt:f.dataUpdatedAt,error:b,errorUpdatedAt:g,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>x.dataUpdateCount||f.errorUpdateCount>x.errorUpdateCount,isFetching:N,isRefetching:N&&!R,isLoadingError:w&&!C,isPaused:"paused"===f.fetchStatus,isPlaceholderData:y,isRefetchError:w&&C,isStale:p(e,t),refetch:this.refetch,promise:this.#s,isEnabled:!1!==(0,l.resolveEnabled)(t.enabled,e)};if(this.options.experimental_prefetchInRender){let t=e=>{"error"===I.status?e.reject(I.error):void 0!==I.data&&e.resolve(I.data)},s=()=>{t(this.#s=I.promise=(0,n.pendingThenable)())},i=this.#s;switch(i.status){case"pending":e.queryHash===r.queryHash&&t(i);break;case"fulfilled":("error"===I.status||I.data!==i.value)&&s();break;case"rejected":("error"!==I.status||I.error!==i.reason)&&s()}}return I}updateResult(){let e=this.#a,t=this.createResult(this.#r,this.options);if(this.#n=this.#r.state,this.#l=this.options,void 0!==this.#n.data&&(this.#d=this.#r),(0,l.shallowEqualObjects)(t,e))return;this.#a=t;let s=()=>{if(!e)return!0;let{notifyOnChangeProps:t}=this.options,s="function"==typeof t?t():t;if("all"===s||!s&&!this.#x.size)return!0;let r=new Set(s??this.#x);return this.options.throwOnError&&r.add("error"),Object.keys(this.#a).some(t=>this.#a[t]!==e[t]&&r.has(t))};this.#R({listeners:s()})}#g(){let e=this.#e.getQueryCache().build(this.#e,this.options);if(e===this.#r)return;let t=this.#r;this.#r=e,this.#i=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#f()}#R(e){r.notifyManager.batch(()=>{e.listeners&&this.listeners.forEach(e=>{e(this.#a)}),this.#e.getQueryCache().notify({query:this.#r,type:"observerResultsUpdated"})})}};function d(e,t){return!1!==(0,l.resolveEnabled)(t.enabled,e)&&void 0===e.state.data&&("error"!==e.state.status||!1!==t.retryOnMount)||void 0!==e.state.data&&u(e,t,t.refetchOnMount)}function u(e,t,s){if(!1!==(0,l.resolveEnabled)(t.enabled,e)&&"static"!==(0,l.resolveStaleTime)(t.staleTime,e)){let r="function"==typeof s?s(e):s;return"always"===r||!1!==r&&p(e,t)}return!1}function h(e,t,s,r){return(e!==t||!1===(0,l.resolveEnabled)(r.enabled,e))&&(!s.suspense||"error"!==e.state.status)&&p(e,s)}function p(e,t){return!1!==(0,l.resolveEnabled)(t.enabled,e)&&e.isStaleByTime((0,l.resolveStaleTime)(t.staleTime,e))}e.i(47167);var x=e.i(71645),m=e.i(12598);e.i(43476);var f=x.createContext((t=!1,{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t})),y=x.createContext(!1);y.Provider;var b=(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()});function g(e,t){return function(e,t,s){let i=x.useContext(y),a=x.useContext(f),n=(0,m.useQueryClient)(s),c=n.defaultQueryOptions(e);if(n.getDefaultOptions().queries?._experimental_beforeQuery?.(c),c._optimisticResults=i?"isRestoring":"optimistic",c.suspense){let e=e=>"static"===e?e:Math.max(e??1e3,1e3),t=c.staleTime;c.staleTime="function"==typeof t?(...s)=>e(t(...s)):e(t),"number"==typeof c.gcTime&&(c.gcTime=Math.max(c.gcTime,1e3))}(c.suspense||c.throwOnError||c.experimental_prefetchInRender)&&!a.isReset()&&(c.retryOnMount=!1),x.useEffect(()=>{a.clearReset()},[a]);let o=!n.getQueryCache().get(c.queryHash),[d]=x.useState(()=>new t(n,c)),u=d.getOptimisticResult(c),h=!i&&!1!==e.subscribed;if(x.useSyncExternalStore(x.useCallback(e=>{let t=h?d.subscribe(r.notifyManager.batchCalls(e)):l.noop;return d.updateResult(),t},[d,h]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),x.useEffect(()=>{d.setOptions(c)},[c,d]),c?.suspense&&u.isPending)throw b(c,d,a);if((({result:e,errorResetBoundary:t,throwOnError:s,query:r,suspense:i})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(i&&void 0===e.data||(0,l.shouldThrowError)(s,[e.error,r])))({result:u,errorResetBoundary:a,throwOnError:c.throwOnError,query:n.getQueryCache().get(c.queryHash),suspense:c.suspense}))throw u.error;if(n.getDefaultOptions().queries?._experimental_afterQuery?.(c,u),c.experimental_prefetchInRender&&!l.isServer&&u.isLoading&&u.isFetching&&!i){let e=o?b(c,d,a):n.getQueryCache().get(c.queryHash)?.promise;e?.catch(l.noop).finally(()=>{d.updateResult()})}return c.notifyOnChangeProps?u:d.trackResult(u)}(e,o,t)}e.i(14272),a.Subscribable,e.i(78138);var v=e.i(9165);e.i(5766);let j={reports:e=>["reports",e],files:["files"],customers:e=>["customers",e],sales:["sales"]};function N(e){return g({queryKey:j.reports(e),queryFn:()=>(0,v.getReports)(e),enabled:!!e})}function R(){return g({queryKey:j.files,queryFn:v.getFiles})}function w(){return g({queryKey:j.sales,queryFn:v.getAllSales})}e.s(["queryKeys",0,j,"useFiles",()=>R,"useReports",()=>N,"useSales",()=>w],54928)},55436,e=>{"use strict";let t=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>t],55436)},25652,e=>{"use strict";let t=(0,e.i(75254).default)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);e.s(["TrendingUp",()=>t],25652)},37727,e=>{"use strict";let t=(0,e.i(75254).default)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);e.s(["X",()=>t],37727)},64659,e=>{"use strict";let t=(0,e.i(75254).default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);e.s(["ChevronDown",()=>t],64659)},46897,e=>{"use strict";let t=(0,e.i(75254).default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);e.s(["MapPin",()=>t],46897)},63059,e=>{"use strict";let t=(0,e.i(75254).default)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);e.s(["ChevronRight",()=>t],63059)},18257,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(78138),i=e.i(54928),a=e.i(55436),n=e.i(46897),l=e.i(25652),c=e.i(37727);function o({searchTerm:e,setSearchTerm:s,selectedArea:r,setSelectedArea:i,selectedRank:o,setSelectedRank:d,isPriorityOnly:u,setIsPriorityOnly:h,areas:p,ranks:x}){return(0,t.jsx)("div",{className:"bg-white rounded border border-sf-border shadow-sm p-4",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(a.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),(0,t.jsx)("input",{type:"text",placeholder:"得意先、直送先...",value:e,onChange:e=>s(e.target.value),className:"w-full pl-10 pr-10 py-2 border border-sf-border rounded focus:outline-none focus:ring-2 focus:ring-sf-light-blue focus:border-transparent"}),e&&(0,t.jsx)("button",{onClick:()=>s(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 p-1 rounded-full hover:bg-gray-100 transition-colors",title:"検索条件をクリア",children:(0,t.jsx)(c.X,{size:16})})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(n.MapPin,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),(0,t.jsxs)("select",{value:r,onChange:e=>i(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-sf-border rounded focus:outline-none focus:ring-2 focus:ring-sf-light-blue focus:border-transparent appearance-none bg-white","aria-label":"エリアで絞り込み",children:[(0,t.jsx)("option",{value:"",children:"すべてのエリア"}),p.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(l.TrendingUp,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),(0,t.jsxs)("select",{value:o,onChange:e=>d(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-sf-border rounded focus:outline-none focus:ring-2 focus:ring-sf-light-blue focus:border-transparent appearance-none bg-white","aria-label":"ランクで絞り込み",children:[(0,t.jsx)("option",{value:"",children:"すべてのランク"}),x.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]}),(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer select-none",children:[(0,t.jsx)("input",{type:"checkbox",checked:u,onChange:e=>h(e.target.checked),className:"w-4 h-4 text-sf-light-blue border-gray-300 rounded focus:ring-sf-light-blue"}),(0,t.jsx)("span",{className:"text-sm text-sf-text",children:"重点顧客のみ表示"})]})})]})})}var d=e.i(64659),u=e.i(63059);let h=(0,e.i(75254).default)("corner-down-right",[["path",{d:"m15 10 5 5-5 5",key:"qqa56n"}],["path",{d:"M4 4v7a4 4 0 0 0 4 4h12",key:"z08zvw"}]]);var p=e.i(22016);function x({customers:e,loading:r,expandedRows:i,toggleRow:a,emptyMessage:n}){return r?(0,t.jsx)("div",{className:"p-8 text-center text-sf-text-weak",children:"読み込み中..."}):0===e.length?(0,t.jsx)("div",{className:"p-8 text-center text-sf-text-weak",children:n||"得意先が見つかりません"}):(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-sm",children:[(0,t.jsx)("thead",{className:"text-xs text-sf-text-weak bg-gray-50 border-b border-sf-border",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-4 py-3 text-left font-medium w-8"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left font-medium",children:"得意先CD/直送先CD"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left font-medium",children:"得意先名/直送先名"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left font-medium",children:"エリア"}),(0,t.jsx)("th",{className:"px-4 py-3 text-center font-medium",children:"ランク"}),(0,t.jsx)("th",{className:"px-4 py-3 text-center font-medium",children:"重点"}),(0,t.jsx)("th",{className:"px-4 py-3 text-center font-medium",children:"総活動数"}),(0,t.jsx)("th",{className:"px-4 py-3 text-center font-medium",children:"訪問"}),(0,t.jsx)("th",{className:"px-4 py-3 text-center font-medium",children:"電話"}),(0,t.jsx)("th",{className:"px-4 py-3 text-center font-medium",children:"デザイン案件"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left font-medium",children:"最終活動日"})]})}),(0,t.jsx)("tbody",{children:e.map(e=>(0,t.jsxs)(s.Fragment,{children:[(0,t.jsxs)("tr",{className:"border-b border-sf-border hover:bg-gray-50 transition-colors",children:[(0,t.jsx)("td",{className:"px-4 py-3 text-center",children:e.subItems&&e.subItems.length>0&&(0,t.jsx)("button",{onClick:()=>a(e.id),className:"p-1 hover:bg-gray-200 rounded","aria-label":i.has(e.id)?"直送先を折りたたむ":"直送先を展開する",title:i.has(e.id)?"直送先を折りたたむ":"直送先を展開する",children:i.has(e.id)?(0,t.jsx)(d.ChevronDown,{size:16,className:"text-gray-500"}):(0,t.jsx)(u.ChevronRight,{size:16,className:"text-gray-500"})})}),(0,t.jsx)("td",{className:"px-4 py-3 text-sf-text font-mono",children:e.code}),(0,t.jsx)("td",{className:"px-4 py-3",children:(0,t.jsx)(p.default,{href:`/customers/detail?code=${e.code}`,className:"font-medium text-sf-light-blue hover:underline",children:e.name})}),(0,t.jsx)("td",{className:"px-4 py-3 text-sf-text",children:e.area||"-"}),(0,t.jsx)("td",{className:"px-4 py-3 text-center",children:e.rank&&(0,t.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800",children:e.rank})}),(0,t.jsx)("td",{className:"px-4 py-3 text-center",children:e.isPriority&&(0,t.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-yellow-100 text-yellow-800",children:"重点"})}),(0,t.jsx)("td",{className:"px-4 py-3 text-center font-semibold text-sf-text",children:e.totalActivities}),(0,t.jsx)("td",{className:"px-4 py-3 text-center text-green-600",children:e.visits}),(0,t.jsx)("td",{className:"px-4 py-3 text-center text-blue-600",children:e.calls}),(0,t.jsx)("td",{className:"px-4 py-3 text-center",children:e.designRequests>0?(0,t.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:e.designRequests}):(0,t.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,t.jsx)("td",{className:"px-4 py-3 text-sf-text",children:e.lastActivity})]}),i.has(e.id)&&e.subItems?.map(e=>(0,t.jsxs)("tr",{className:"bg-sf-bg-light border-b border-sf-border hover:bg-gray-100",children:[(0,t.jsx)("td",{className:"px-4 py-3"}),(0,t.jsxs)("td",{className:"px-4 py-3 text-sf-text-weak font-mono pl-8 text-xs flex items-center gap-1",children:[(0,t.jsx)(h,{size:12,className:"text-sf-text-weak"}),e.directDeliveryCode]}),(0,t.jsxs)("td",{className:"px-4 py-3 pl-8 text-sm",children:[(0,t.jsx)("span",{className:"text-sf-text-weak text-xs border border-gray-200 rounded px-1 mr-2 bg-white",children:"直送"}),(0,t.jsx)(p.default,{href:`/customers/detail?code=${e.code}&ddCode=${e.directDeliveryCode}`,className:"text-sf-light-blue hover:underline",children:e.directDeliveryName})]}),(0,t.jsx)("td",{className:"px-4 py-3 text-sf-text-weak text-xs",children:e.area||"-"}),(0,t.jsx)("td",{className:"px-4 py-3 text-center",children:e.rank&&(0,t.jsx)("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-gray-50 text-gray-600",children:e.rank})}),(0,t.jsx)("td",{className:"px-4 py-3 text-center",children:e.isPriority&&(0,t.jsx)("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-yellow-50 text-yellow-700",children:"重点"})}),(0,t.jsx)("td",{className:"px-4 py-3 text-center text-xs text-sf-text-weak",children:e.totalActivities}),(0,t.jsx)("td",{className:"px-4 py-3 text-center text-xs text-green-600/70",children:e.visits}),(0,t.jsx)("td",{className:"px-4 py-3 text-center text-xs text-blue-600/70",children:e.calls}),(0,t.jsx)("td",{className:"px-4 py-3 text-center",children:e.designRequests>0&&(0,t.jsx)("span",{className:"text-xs text-purple-800/70",children:e.designRequests})}),(0,t.jsx)("td",{className:"px-4 py-3 text-sf-text-weak text-xs",children:e.lastActivity})]},e.id))]},e.id))})]})})}function m({customers:e,filteredCustomers:s}){return(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{className:"bg-white p-4 rounded border border-sf-border shadow-sm",children:[(0,t.jsx)("p",{className:"text-sm text-sf-text-weak mb-1",children:"総得意先数"}),(0,t.jsx)("p",{className:"text-2xl font-semibold text-sf-text",children:e.length})]}),(0,t.jsxs)("div",{className:"bg-white p-4 rounded border border-sf-border shadow-sm",children:[(0,t.jsx)("p",{className:"text-sm text-sf-text-weak mb-1",children:"検索結果"}),(0,t.jsx)("p",{className:"text-2xl font-semibold text-sf-light-blue",children:s.length})]}),(0,t.jsxs)("div",{className:"bg-white p-4 rounded border border-sf-border shadow-sm",children:[(0,t.jsx)("p",{className:"text-sm text-sf-text-weak mb-1",children:"重点顧客"}),(0,t.jsx)("p",{className:"text-2xl font-semibold text-yellow-600",children:e.filter(e=>e.isPriority).length})]}),(0,t.jsxs)("div",{className:"bg-white p-4 rounded border border-sf-border shadow-sm",children:[(0,t.jsx)("p",{className:"text-sm text-sf-text-weak mb-1",children:"総活動数"}),(0,t.jsx)("p",{className:"text-2xl font-semibold text-green-600",children:e.reduce((e,t)=>e+t.totalActivities,0)})]})]})}var f=e.i(5766);function y(){let{selectedFile:e}=(0,r.useFile)(),{data:a,isLoading:n,error:l}=(0,i.useReports)(e||void 0),c=(0,s.useMemo)(()=>{let e,t;return a?(e=new Map,t=(e,t,s,r,i,a=!1,n="",l="")=>({id:a?`${e}-${n}`:e,code:e,name:t,area:s,totalActivities:0,visits:0,calls:0,designRequests:0,designNos:new Set,isPriority:i,lastActivity:"",rank:r,isDirectDelivery:a,directDeliveryCode:n,directDeliveryName:l,subItems:a?void 0:[]}),a.forEach(s=>{let r=String(s.得意先CD||""),i=String(s.訪問先名||"").split("　")[0];if(!r)return;e.has(r)||e.set(r,t(r,i,String(s.エリア||""),String(s.ランク||""),!!(s.重点顧客&&"-"!==s.重点顧客&&""!==s.重点顧客)));let a=e.get(r),n=s.直送先CD?String(s.直送先CD):"",l=s.直送先名?String(s.直送先名):"",c=!!(s.重点顧客&&"-"!==s.重点顧客&&""!==s.重点顧客),o=a;if(n){let e=a.subItems?.find(e=>e.directDeliveryCode===n);e?c&&(e.isPriority=!0):(e=t(r,i,String(s.エリア||""),String(s.ランク||""),c,!0,n,l),a.subItems?.push(e)),o=e}o.totalActivities++,s.行動内容&&s.行動内容.includes("訪問")&&o.visits++,s.行動内容&&s.行動内容.includes("電話")&&o.calls++;let d=s["システム確認用デザインNo."];d&&!isNaN(Number(d))&&o.designNos&&o.designNos.add(String(d));let u=String(s.日付||"");if(!o.lastActivity||u>o.lastActivity){o.lastActivity=u;let e=String(s.ランク||"").trim();e&&"-"!==e&&(o.rank=e)}o!==a&&(a.totalActivities++,s.行動内容&&s.行動内容.includes("訪問")&&a.visits++,s.行動内容&&s.行動内容.includes("電話")&&a.calls++,d&&!isNaN(Number(d))&&a.designNos&&a.designNos.add(String(d)),(!a.lastActivity||u>a.lastActivity)&&(a.lastActivity=u))}),Array.from(e.values()).map(e=>({...e,designRequests:e.designNos?.size||0,subItems:e.subItems?.map(e=>({...e,designRequests:e.designNos?.size||0}))})).sort((e,t)=>t.totalActivities-e.totalActivities)):[]},[a]),[d,u]=(0,s.useState)([]),[h,p]=(0,s.useState)(""),[y,b]=(0,s.useState)(""),[g,v]=(0,s.useState)(""),[j,N]=(0,s.useState)(!1),[R,w]=(0,s.useState)(new Set),[S,C]=(0,s.useState)(1);(0,s.useEffect)(()=>{l&&f.default.error("得意先データの読み込みに失敗しました")},[l]),(0,s.useEffect)(()=>{u(c)},[c]),(0,s.useEffect)(()=>{let e=c;if(h.trim()||y||g||j){let t=h.toLowerCase().trim(),s=new Set,r=e=>{let s=e.name.toLowerCase().includes(t),r=e.code.toLowerCase().includes(t),i=e.directDeliveryName?.toLowerCase().includes(t),a=e.directDeliveryCode?.toLowerCase().includes(t);return s||r||i||a};e=e.map(e=>{if(y&&e.area!==y||g&&e.rank!==g)return null;let i=e.isPriority,a=e.subItems?.filter(e=>e.isPriority)||[];if(j){if(!i&&0===a.length)return null;if(t){let t=r(e),n=a.filter(e=>r(e));return t||n.length>0?(n.length>0&&s.add(e.id),{...e,subItems:i?a:n}):null}return{...e,subItems:a}}let n=!t||r(e),l=e.subItems||[];if(t&&(l=l.filter(e=>r(e))),n||l.length>0)return t&&l.length>0&&(s.add(e.id),!n)?{...e,subItems:l}:n?{...e}:{...e,subItems:l};return null}).filter(e=>null!==e),t&&w(s)}u(e),C(1)},[h,y,g,j,c]);let I=Array.from(new Set(c.map(e=>e.area).filter(Boolean))).sort(),k=Array.from(new Set(c.map(e=>e.rank).filter(Boolean))).sort();return(0,t.jsxs)("div",{className:"space-y-6 animate-fadeIn",children:[(0,t.jsx)("div",{className:"flex justify-between items-center",children:(0,t.jsx)("h1",{className:"text-2xl font-semibold text-sf-text",children:"得意先一覧"})}),n&&(0,t.jsx)("div",{className:"bg-white rounded border border-sf-border shadow-sm p-8",children:(0,t.jsxs)("div",{className:"flex items-center justify-center gap-3",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-sf-light-blue"}),(0,t.jsx)("span",{className:"text-sf-text-weak",children:"読み込み中..."})]})}),l&&!n&&(0,t.jsx)("div",{className:"bg-red-50 border border-red-200 rounded p-4 text-red-700",children:"データの読み込みに失敗しました"}),!n&&!l&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o,{searchTerm:h,setSearchTerm:p,selectedArea:y,setSelectedArea:b,selectedRank:g,setSelectedRank:v,isPriorityOnly:j,setIsPriorityOnly:N,areas:I,ranks:k}),(0,t.jsx)(m,{customers:c,filteredCustomers:d}),(0,t.jsxs)("div",{className:"bg-white rounded border border-sf-border shadow-sm overflow-hidden",children:[(0,t.jsxs)("div",{className:"px-4 py-3 border-b border-sf-border bg-gray-50 flex justify-between items-center",children:[(0,t.jsxs)("h2",{className:"font-semibold text-sm text-sf-text",children:["得意先一覧 (",d.length,"件)"]}),(0,t.jsxs)("span",{className:"text-xs text-gray-500",children:[Math.min((S-1)*50+1,d.length)," - ",Math.min(50*S,d.length)," 表示中"]})]}),(0,t.jsx)(x,{customers:d.slice((S-1)*50,50*S),loading:n,expandedRows:R,toggleRow:e=>{let t=new Set(R);t.has(e)?t.delete(e):t.add(e),w(t)}}),d.length>50&&(0,t.jsxs)("div",{className:"px-4 py-3 border-t border-sf-border bg-gray-50 flex justify-center items-center gap-4",children:[(0,t.jsx)("button",{onClick:()=>{C(e=>Math.max(1,e-1)),window.scrollTo({top:0,behavior:"smooth"})},disabled:1===S,className:"px-3 py-1 bg-white border border-gray-300 rounded text-sm disabled:opacity-50 hover:bg-gray-50 transition-colors",children:"前へ"}),(0,t.jsxs)("span",{className:"text-sm text-gray-600",children:[S," / ",Math.ceil(d.length/50)," ページ"]}),(0,t.jsx)("button",{onClick:()=>{C(e=>Math.min(Math.ceil(d.length/50),e+1)),window.scrollTo({top:0,behavior:"smooth"})},disabled:S===Math.ceil(d.length/50),className:"px-3 py-1 bg-white border border-gray-300 rounded text-sm disabled:opacity-50 hover:bg-gray-50 transition-colors",children:"次へ"})]})]})]})]})}e.s(["default",()=>y],18257)}]);