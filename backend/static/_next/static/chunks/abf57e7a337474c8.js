(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,54928,e=>{"use strict";let t;var s=e.i(75555),r=e.i(40143),i=e.i(86491),a=e.i(15823),l=e.i(93803),n=e.i(19273),c=e.i(80166),o=class extends a.Subscribable{constructor(e,t){super(),this.options=t,this.#e=e,this.#t=null,this.#s=(0,l.pendingThenable)(),this.bindMethods(),this.setOptions(t)}#e;#r=void 0;#i=void 0;#a=void 0;#l;#n;#s;#t;#c;#o;#d;#u;#h;#x;#m=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#r.addObserver(this),d(this.#r,this.options)?this.#p():this.updateResult(),this.#f())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return u(this.#r,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return u(this.#r,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#g(),this.#b(),this.#r.removeObserver(this)}setOptions(e){let t=this.options,s=this.#r;if(this.options=this.#e.defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof(0,n.resolveEnabled)(this.options.enabled,this.#r))throw Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#y(),this.#r.setOptions(this.options),t._defaulted&&!(0,n.shallowEqualObjects)(this.options,t)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#r,observer:this});let r=this.hasListeners();r&&h(this.#r,s,this.options,t)&&this.#p(),this.updateResult(),r&&(this.#r!==s||(0,n.resolveEnabled)(this.options.enabled,this.#r)!==(0,n.resolveEnabled)(t.enabled,this.#r)||(0,n.resolveStaleTime)(this.options.staleTime,this.#r)!==(0,n.resolveStaleTime)(t.staleTime,this.#r))&&this.#v();let i=this.#j();r&&(this.#r!==s||(0,n.resolveEnabled)(this.options.enabled,this.#r)!==(0,n.resolveEnabled)(t.enabled,this.#r)||i!==this.#x)&&this.#N(i)}getOptimisticResult(e){var t,s;let r=this.#e.getQueryCache().build(this.#e,e),i=this.createResult(r,e);return t=this,s=i,(0,n.shallowEqualObjects)(t.getCurrentResult(),s)||(this.#a=i,this.#n=this.options,this.#l=this.#r.state),i}getCurrentResult(){return this.#a}trackResult(e,t){return new Proxy(e,{get:(e,s)=>(this.trackProp(s),t?.(s),"promise"===s&&(this.trackProp("data"),this.options.experimental_prefetchInRender||"pending"!==this.#s.status||this.#s.reject(Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(e,s))})}trackProp(e){this.#m.add(e)}getCurrentQuery(){return this.#r}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){let t=this.#e.defaultQueryOptions(e),s=this.#e.getQueryCache().build(this.#e,t);return s.fetch().then(()=>this.createResult(s,t))}fetch(e){return this.#p({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#a))}#p(e){this.#y();let t=this.#r.fetch(this.options,e);return e?.throwOnError||(t=t.catch(n.noop)),t}#v(){this.#g();let e=(0,n.resolveStaleTime)(this.options.staleTime,this.#r);if(n.isServer||this.#a.isStale||!(0,n.isValidTimeout)(e))return;let t=(0,n.timeUntilStale)(this.#a.dataUpdatedAt,e);this.#u=c.timeoutManager.setTimeout(()=>{this.#a.isStale||this.updateResult()},t+1)}#j(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#r):this.options.refetchInterval)??!1}#N(e){this.#b(),this.#x=e,!n.isServer&&!1!==(0,n.resolveEnabled)(this.options.enabled,this.#r)&&(0,n.isValidTimeout)(this.#x)&&0!==this.#x&&(this.#h=c.timeoutManager.setInterval(()=>{(this.options.refetchIntervalInBackground||s.focusManager.isFocused())&&this.#p()},this.#x))}#f(){this.#v(),this.#N(this.#j())}#g(){this.#u&&(c.timeoutManager.clearTimeout(this.#u),this.#u=void 0)}#b(){this.#h&&(c.timeoutManager.clearInterval(this.#h),this.#h=void 0)}createResult(e,t){let s,r=this.#r,a=this.options,c=this.#a,o=this.#l,u=this.#n,m=e!==r?e.state:this.#i,{state:p}=e,f={...p},g=!1;if(t._optimisticResults){let s=this.hasListeners(),l=!s&&d(e,t),n=s&&h(e,r,t,a);(l||n)&&(f={...f,...(0,i.fetchState)(p.data,e.options)}),"isRestoring"===t._optimisticResults&&(f.fetchStatus="idle")}let{error:b,errorUpdatedAt:y,status:v}=f;s=f.data;let j=!1;if(void 0!==t.placeholderData&&void 0===s&&"pending"===v){let e;c?.isPlaceholderData&&t.placeholderData===u?.placeholderData?(e=c.data,j=!0):e="function"==typeof t.placeholderData?t.placeholderData(this.#d?.state.data,this.#d):t.placeholderData,void 0!==e&&(v="success",s=(0,n.replaceData)(c?.data,e,t),g=!0)}if(t.select&&void 0!==s&&!j)if(c&&s===o?.data&&t.select===this.#c)s=this.#o;else try{this.#c=t.select,s=t.select(s),s=(0,n.replaceData)(c?.data,s,t),this.#o=s,this.#t=null}catch(e){this.#t=e}this.#t&&(b=this.#t,s=this.#o,y=Date.now(),v="error");let N="fetching"===f.fetchStatus,w="pending"===v,R="error"===v,S=w&&N,C=void 0!==s,k={status:v,fetchStatus:f.fetchStatus,isPending:w,isSuccess:"success"===v,isError:R,isInitialLoading:S,isLoading:S,data:s,dataUpdatedAt:f.dataUpdatedAt,error:b,errorUpdatedAt:y,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>m.dataUpdateCount||f.errorUpdateCount>m.errorUpdateCount,isFetching:N,isRefetching:N&&!w,isLoadingError:R&&!C,isPaused:"paused"===f.fetchStatus,isPlaceholderData:g,isRefetchError:R&&C,isStale:x(e,t),refetch:this.refetch,promise:this.#s,isEnabled:!1!==(0,n.resolveEnabled)(t.enabled,e)};if(this.options.experimental_prefetchInRender){let t=e=>{"error"===k.status?e.reject(k.error):void 0!==k.data&&e.resolve(k.data)},s=()=>{t(this.#s=k.promise=(0,l.pendingThenable)())},i=this.#s;switch(i.status){case"pending":e.queryHash===r.queryHash&&t(i);break;case"fulfilled":("error"===k.status||k.data!==i.value)&&s();break;case"rejected":("error"!==k.status||k.error!==i.reason)&&s()}}return k}updateResult(){let e=this.#a,t=this.createResult(this.#r,this.options);if(this.#l=this.#r.state,this.#n=this.options,void 0!==this.#l.data&&(this.#d=this.#r),(0,n.shallowEqualObjects)(t,e))return;this.#a=t;let s=()=>{if(!e)return!0;let{notifyOnChangeProps:t}=this.options,s="function"==typeof t?t():t;if("all"===s||!s&&!this.#m.size)return!0;let r=new Set(s??this.#m);return this.options.throwOnError&&r.add("error"),Object.keys(this.#a).some(t=>this.#a[t]!==e[t]&&r.has(t))};this.#w({listeners:s()})}#y(){let e=this.#e.getQueryCache().build(this.#e,this.options);if(e===this.#r)return;let t=this.#r;this.#r=e,this.#i=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#f()}#w(e){r.notifyManager.batch(()=>{e.listeners&&this.listeners.forEach(e=>{e(this.#a)}),this.#e.getQueryCache().notify({query:this.#r,type:"observerResultsUpdated"})})}};function d(e,t){return!1!==(0,n.resolveEnabled)(t.enabled,e)&&void 0===e.state.data&&("error"!==e.state.status||!1!==t.retryOnMount)||void 0!==e.state.data&&u(e,t,t.refetchOnMount)}function u(e,t,s){if(!1!==(0,n.resolveEnabled)(t.enabled,e)&&"static"!==(0,n.resolveStaleTime)(t.staleTime,e)){let r="function"==typeof s?s(e):s;return"always"===r||!1!==r&&x(e,t)}return!1}function h(e,t,s,r){return(e!==t||!1===(0,n.resolveEnabled)(r.enabled,e))&&(!s.suspense||"error"!==e.state.status)&&x(e,s)}function x(e,t){return!1!==(0,n.resolveEnabled)(t.enabled,e)&&e.isStaleByTime((0,n.resolveStaleTime)(t.staleTime,e))}e.i(47167);var m=e.i(71645),p=e.i(12598);e.i(43476);var f=m.createContext((t=!1,{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t})),g=m.createContext(!1);g.Provider;var b=(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()});function y(e,t){return function(e,t,s){let i=m.useContext(g),a=m.useContext(f),l=(0,p.useQueryClient)(s),c=l.defaultQueryOptions(e);if(l.getDefaultOptions().queries?._experimental_beforeQuery?.(c),c._optimisticResults=i?"isRestoring":"optimistic",c.suspense){let e=e=>"static"===e?e:Math.max(e??1e3,1e3),t=c.staleTime;c.staleTime="function"==typeof t?(...s)=>e(t(...s)):e(t),"number"==typeof c.gcTime&&(c.gcTime=Math.max(c.gcTime,1e3))}(c.suspense||c.throwOnError||c.experimental_prefetchInRender)&&!a.isReset()&&(c.retryOnMount=!1),m.useEffect(()=>{a.clearReset()},[a]);let o=!l.getQueryCache().get(c.queryHash),[d]=m.useState(()=>new t(l,c)),u=d.getOptimisticResult(c),h=!i&&!1!==e.subscribed;if(m.useSyncExternalStore(m.useCallback(e=>{let t=h?d.subscribe(r.notifyManager.batchCalls(e)):n.noop;return d.updateResult(),t},[d,h]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),m.useEffect(()=>{d.setOptions(c)},[c,d]),c?.suspense&&u.isPending)throw b(c,d,a);if((({result:e,errorResetBoundary:t,throwOnError:s,query:r,suspense:i})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(i&&void 0===e.data||(0,n.shouldThrowError)(s,[e.error,r])))({result:u,errorResetBoundary:a,throwOnError:c.throwOnError,query:l.getQueryCache().get(c.queryHash),suspense:c.suspense}))throw u.error;if(l.getDefaultOptions().queries?._experimental_afterQuery?.(c,u),c.experimental_prefetchInRender&&!n.isServer&&u.isLoading&&u.isFetching&&!i){let e=o?b(c,d,a):l.getQueryCache().get(c.queryHash)?.promise;e?.catch(n.noop).finally(()=>{d.updateResult()})}return c.notifyOnChangeProps?u:d.trackResult(u)}(e,o,t)}e.i(14272),a.Subscribable,e.i(78138);var v=e.i(9165);e.i(5766);let j={reports:e=>["reports",e],files:["files"],customers:e=>["customers",e],sales:["sales"]};function N(e){return y({queryKey:j.reports(e),queryFn:()=>(0,v.getReports)(e),enabled:!!e})}function w(){return y({queryKey:j.files,queryFn:v.getFiles})}function R(e){return y({queryKey:j.customers(e),queryFn:()=>(0,v.getCustomers)(e),enabled:!!e})}function S(){return y({queryKey:j.sales,queryFn:v.getAllSales})}e.s(["queryKeys",0,j,"useCustomers",()=>R,"useFiles",()=>w,"useReports",()=>N,"useSales",()=>S],54928)},55436,e=>{"use strict";let t=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>t],55436)},25652,e=>{"use strict";let t=(0,e.i(75254).default)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);e.s(["TrendingUp",()=>t],25652)},84614,e=>{"use strict";let t=(0,e.i(75254).default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);e.s(["User",()=>t],84614)},37727,e=>{"use strict";let t=(0,e.i(75254).default)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);e.s(["X",()=>t],37727)},73708,e=>{"use strict";let t=(0,e.i(75254).default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);e.s(["Image",()=>t],73708)},47615,e=>{"use strict";let t=(0,e.i(75254).default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);e.s(["Filter",()=>t],47615)},52008,e=>{"use strict";let t=(0,e.i(75254).default)("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]);e.s(["Layers",()=>t],52008)},64659,e=>{"use strict";let t=(0,e.i(75254).default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);e.s(["ChevronDown",()=>t],64659)},55900,e=>{"use strict";let t=(0,e.i(75254).default)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);e.s(["ChevronUp",()=>t],55900)},98444,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(78138),i=e.i(54928),a=e.i(9165),l=e.i(55436),n=e.i(87316),c=e.i(84614),o=e.i(78583),d=e.i(64659),u=e.i(55900),h=e.i(88844),x=e.i(52008),m=e.i(25652),p=e.i(47615),f=e.i(73708),g=e.i(37727),b=e.i(22016),y=e.i(5766);function v(){let{selectedFile:e}=(0,r.useFile)(),{data:v=[],isLoading:j,error:N}=(0,i.useReports)(e||void 0),[w,R]=(0,s.useState)(""),[S,C]=(0,s.useState)([]),[k,T]=(0,s.useState)([]),[Q,I]=(0,s.useState)([]),[E,O]=(0,s.useState)([]),[q,F]=(0,s.useState)(new Set),[z,P]=(0,s.useState)(!1),[D,M]=(0,s.useState)(!1),[U,L]=(0,s.useState)(!1),[A,_]=(0,s.useState)(!1),[$,H]=(0,s.useState)([]),[K,W]=(0,s.useState)(!1),[B,V]=(0,s.useState)(""),X=async(t,s)=>{if(s.stopPropagation(),t){_(!0),V(String(t));try{let s=await (0,a.searchDesignImages)(String(t),e||void 0);s.images&&s.images.length>0?(H(s.images),W(!0),y.default.success(`${s.images.length}件の画像が見つかりました`)):(y.default.error("画像が見つかりませんでした"),H([]))}catch(e){console.error("Search error:",e),y.default.error("画像検索中にエラーが発生しました")}finally{_(!1)}}};(0,s.useEffect)(()=>{N&&y.default.error("デザイン依頼データの読み込みに失敗しました")},[N]);let G=(0,s.useMemo)(()=>{let e,t;return e=new Map,v.forEach(t=>{let s=t["システム確認用デザインNo."];if(s){let r=String(s).trim();e.has(r)||e.set(r,{designNo:r,customerCode:String(t.得意先CD||""),customerName:String(t.訪問先名||""),designProposal:String(t["デザイン提案有無"]||""),designType:String(t["デザイン種別"]||""),designName:String(t["デザイン名"]||""),designProgress:String(t["デザイン進捗状況"]||""),requests:[]}),e.get(r).requests.push(t)}}),(t=Array.from(e.values()).map(e=>{let t=e.requests.sort((e,t)=>{let s=String(e.日付||""),r=String(t.日付||"");return s.localeCompare(r)}),s=t[t.length-1];return{...e,designProgress:String(s?.["デザイン進捗状況"]||e.designProgress||""),requests:t}})).sort((e,t)=>{let s=e.requests[e.requests.length-1],r=t.requests[t.requests.length-1],i=s?.日付||"",a=(r?.日付||"").localeCompare(i);return 0!==a?a:String(t.designNo).localeCompare(String(e.designNo),void 0,{numeric:!0})}),t},[v]),J=(0,s.useMemo)(()=>{let e=new Map;return G.forEach(t=>{t.customerCode&&t.customerName&&!e.has(t.customerCode)&&e.set(t.customerCode,t.customerName)}),Array.from(e.entries()).map(([e,t])=>({code:e,name:t})).sort((e,t)=>e.code.localeCompare(t.code))},[G]),Y=(0,s.useMemo)(()=>{let e=G;S.length>0&&(e=e.filter(e=>S.includes(e.customerCode)));let t=new Set;return e.forEach(e=>{e.designType&&t.add(e.designType)}),Array.from(t).sort()},[G,S]),Z=(0,s.useMemo)(()=>{let e=G;S.length>0&&(e=e.filter(e=>S.includes(e.customerCode))),k.length>0&&(e=e.filter(e=>k.includes(e.designType)));let t=new Set;return e.forEach(e=>{e.designProgress&&t.add(e.designProgress)}),Array.from(t).sort()},[G,S,k]);(0,s.useEffect)(()=>{let e=G;if(S.length>0&&(e=e.filter(e=>S.includes(e.customerCode))),k.length>0&&(e=e.filter(e=>k.includes(e.designType))),Q.length>0&&(e=e.filter(e=>Q.includes(e.designProgress))),w.trim()){let t=w.toLowerCase();e=e.filter(e=>String(e.designNo).includes(t)||e.customerCode.toLowerCase().includes(t)||e.customerName.toLowerCase().includes(t)||e.designName.toLowerCase().includes(t)||e.designType.toLowerCase().includes(t))}O(e)},[w,S,k,Q,G]);let ee=e=>{if(!e||"-"===e)return null;let s={出稿:"bg-green-100 text-green-800",新規:"bg-blue-50 text-blue-700","50％未満":"bg-blue-100 text-blue-800","80％未満":"bg-blue-200 text-blue-900","80％以上":"bg-blue-300 text-blue-950",保留:"bg-yellow-100 text-yellow-800","不採用（コンペ負け）":"bg-red-100 text-red-800","不採用（企画倒れ）":"bg-red-100 text-red-800"}[e]||"bg-gray-100 text-gray-800";return(0,t.jsx)("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${s}`,children:e})};return(0,t.jsxs)("div",{className:"space-y-6 animate-fadeIn",children:[(0,t.jsx)("div",{className:"flex justify-between items-center",children:(0,t.jsx)("h1",{className:"text-2xl font-semibold text-sf-text",children:"デザイン依頼検索"})}),(0,t.jsx)("div",{className:"bg-white rounded border border-sf-border shadow-sm p-4",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(l.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),(0,t.jsx)("input",{type:"text",placeholder:"デザインNo.、得意先、デザイン名、種別で検索...",value:w,onChange:e=>R(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-sf-border rounded focus:outline-none focus:ring-2 focus:ring-sf-light-blue focus:border-transparent"})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2 px-3 py-2 border border-sf-border rounded bg-white cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>P(!z),children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(p.Filter,{className:"text-gray-400",size:20}),(0,t.jsxs)("span",{className:"text-sm font-medium text-sf-text",children:["得意先 ",S.length>0&&`(${S.length})`]})]}),(0,t.jsx)(d.ChevronDown,{size:16,className:`text-gray-400 transition-transform ${z?"rotate-180":""}`})]}),z&&(0,t.jsxs)("div",{className:"absolute z-10 mt-2 w-full p-3 border border-sf-border rounded bg-white shadow-lg max-h-72 overflow-y-auto",children:[(0,t.jsx)("div",{className:"space-y-2",children:J.map(e=>(0,t.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-gray-50 p-1 rounded",children:[(0,t.jsx)("input",{type:"checkbox",checked:S.includes(e.code),onChange:t=>{t.target.checked?C([...S,e.code]):C(S.filter(t=>t!==e.code))},className:"w-4 h-4 text-sf-light-blue border-gray-300 rounded focus:ring-sf-light-blue"}),(0,t.jsxs)("span",{className:"text-sm text-sf-text flex-1",children:[e.code," - ",e.name]})]},e.code))}),S.length>0&&(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),C([])},className:"mt-2 text-xs text-sf-light-blue hover:underline",children:"すべてクリア"})]})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2 px-3 py-2 border border-sf-border rounded bg-white cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>M(!D),children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(x.Layers,{className:"text-gray-400",size:20}),(0,t.jsxs)("span",{className:"text-sm font-medium text-sf-text",children:["種別 ",k.length>0&&`(${k.length})`]})]}),(0,t.jsx)(d.ChevronDown,{size:16,className:`text-gray-400 transition-transform ${D?"rotate-180":""}`})]}),D&&(0,t.jsxs)("div",{className:"absolute z-10 mt-2 w-full p-3 border border-sf-border rounded bg-white shadow-lg max-h-72 overflow-y-auto",children:[(0,t.jsx)("div",{className:"space-y-2",children:Y.map(e=>(0,t.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-gray-50 p-1 rounded",children:[(0,t.jsx)("input",{type:"checkbox",checked:k.includes(e),onChange:t=>{t.target.checked?T([...k,e]):T(k.filter(t=>t!==e))},className:"w-4 h-4 text-sf-light-blue border-gray-300 rounded focus:ring-sf-light-blue"}),(0,t.jsx)("span",{className:"text-sm text-sf-text flex-1",children:e})]},e))}),k.length>0&&(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),T([])},className:"mt-2 text-xs text-sf-light-blue hover:underline",children:"すべてクリア"})]})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2 px-3 py-2 border border-sf-border rounded bg-white cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>L(!U),children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(m.TrendingUp,{className:"text-gray-400",size:20}),(0,t.jsxs)("span",{className:"text-sm font-medium text-sf-text",children:["進捗状況 ",Q.length>0&&`(${Q.length})`]})]}),(0,t.jsx)(d.ChevronDown,{size:16,className:`text-gray-400 transition-transform ${U?"rotate-180":""}`})]}),U&&(0,t.jsxs)("div",{className:"absolute z-10 mt-2 w-full p-3 border border-sf-border rounded bg-white shadow-lg max-h-72 overflow-y-auto",children:[(0,t.jsx)("div",{className:"space-y-2",children:Z.map(e=>(0,t.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-gray-50 p-1 rounded",children:[(0,t.jsx)("input",{type:"checkbox",checked:Q.includes(e),onChange:t=>{t.target.checked?I([...Q,e]):I(Q.filter(t=>t!==e))},className:"w-4 h-4 text-sf-light-blue border-gray-300 rounded focus:ring-sf-light-blue"}),(0,t.jsx)("span",{className:"text-sm text-sf-text flex-1",children:ee(e)||e})]},e))}),Q.length>0&&(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),I([])},className:"mt-2 text-xs text-sf-light-blue hover:underline",children:"すべてクリア"})]})]})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"bg-white p-4 rounded border border-sf-border shadow-sm",children:[(0,t.jsx)("p",{className:"text-sm text-sf-text-weak mb-1",children:"デザイン依頼"}),(0,t.jsx)("p",{className:"text-2xl font-semibold text-sf-text",children:G.length})]}),(0,t.jsxs)("div",{className:"bg-white p-4 rounded border border-sf-border shadow-sm",children:[(0,t.jsx)("p",{className:"text-sm text-sf-text-weak mb-1",children:"検索結果"}),(0,t.jsx)("p",{className:"text-2xl font-semibold text-sf-light-blue",children:E.length})]}),(0,t.jsxs)("div",{className:"bg-white p-4 rounded border border-sf-border shadow-sm",children:[(0,t.jsx)("p",{className:"text-sm text-sf-text-weak mb-1",children:"総活動記録数"}),(0,t.jsx)("p",{className:"text-2xl font-semibold text-green-600",children:E.reduce((e,t)=>e+t.requests.length,0)})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded border border-sf-border shadow-sm overflow-hidden",children:[(0,t.jsx)("div",{className:"px-4 py-3 border-b border-sf-border bg-gray-50",children:(0,t.jsx)("h2",{className:"font-semibold text-sm text-sf-text",children:"デザイン依頼一覧"})}),j?(0,t.jsx)("div",{className:"p-8 text-center text-sf-text-weak",children:"読み込み中..."}):0===E.length?(0,t.jsx)("div",{className:"p-8 text-center text-sf-text-weak",children:w||S||k||Q?"検索結果が見つかりません":"デザイン依頼が見つかりません"}):(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-sm",children:[(0,t.jsx)("thead",{className:"text-xs text-sf-text-weak bg-gray-50 border-b border-sf-border",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-4 py-3 text-left font-medium w-12"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left font-medium",children:"デザインNo."}),(0,t.jsx)("th",{className:"px-4 py-3 text-left font-medium",children:"得意先CD"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left font-medium",children:"得意先名"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left font-medium",children:"デザイン名"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left font-medium",children:"種別"}),(0,t.jsx)("th",{className:"px-4 py-3 text-center font-medium",children:"進捗状況"}),(0,t.jsx)("th",{className:"px-4 py-3 text-center font-medium",children:"活動回数"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left font-medium",children:"最終活動日"})]})}),(0,t.jsx)("tbody",{children:E.map(e=>{let r=q.has(e.designNo),i=e.requests[e.requests.length-1];return(0,t.jsxs)(s.default.Fragment,{children:[(0,t.jsxs)("tr",{className:"border-b border-sf-border hover:bg-gray-50 transition-colors cursor-pointer",onClick:()=>{var t;let s;return t=e.designNo,void((s=new Set(q)).has(t)?s.delete(t):s.add(t),F(s))},children:[(0,t.jsx)("td",{className:"px-4 py-3",children:r?(0,t.jsx)(u.ChevronUp,{size:16,className:"text-sf-light-blue"}):(0,t.jsx)(d.ChevronDown,{size:16,className:"text-gray-400"})}),(0,t.jsx)("td",{className:"px-4 py-3 font-medium text-sf-light-blue",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[e.designNo,(0,t.jsx)("button",{onClick:t=>X(e.designNo,t),className:"p-1 rounded hover:bg-sf-light-blue/10 text-pink-500 transition-colors",title:"関連画像を検索",children:(0,t.jsx)(f.Image,{size:16})})]})}),(0,t.jsx)("td",{className:"px-4 py-3 text-sf-text",children:e.customerCode}),(0,t.jsx)("td",{className:"px-4 py-3 text-sf-text font-medium",children:(0,t.jsx)(b.default,{href:`/customers/${e.customerCode}`,className:"text-sf-light-blue hover:underline",onClick:e=>e.stopPropagation(),children:e.customerName})}),(0,t.jsx)("td",{className:"px-4 py-3 text-sf-text",children:e.designName||"-"}),(0,t.jsx)("td",{className:"px-4 py-3 text-sf-text-weak text-xs",children:e.designType||"-"}),(0,t.jsx)("td",{className:"px-4 py-3 text-center",children:ee(e.designProgress)}),(0,t.jsx)("td",{className:"px-4 py-3 text-center",children:(0,t.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[e.requests.length,"件"]})}),(0,t.jsx)("td",{className:"px-4 py-3 text-sf-text",children:i.日付})]},e.designNo),r&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:9,className:"bg-gray-50 p-0",children:(0,t.jsxs)("div",{className:"px-8 py-4",children:[(0,t.jsx)("div",{className:"mb-4 p-4 bg-white rounded border border-sf-border",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)(h.Package,{size:16,className:"text-sf-light-blue mt-0.5"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-sf-text-weak",children:"デザイン名"}),(0,t.jsx)("p",{className:"text-sm font-medium text-sf-text",children:e.designName||"未設定"})]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)(x.Layers,{size:16,className:"text-purple-600 mt-0.5"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-sf-text-weak",children:"デザイン種別"}),(0,t.jsx)("p",{className:"text-sm font-medium text-sf-text",children:e.designType||"未設定"})]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)(m.TrendingUp,{size:16,className:"text-green-600 mt-0.5"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-sf-text-weak",children:"進捗状況"}),(0,t.jsx)("p",{className:"text-sm font-medium text-sf-text",children:e.designProgress||"未設定"})]})]})]})}),(0,t.jsxs)("h3",{className:"text-sm font-semibold text-sf-text mb-3 flex items-center gap-2",children:[(0,t.jsx)(o.FileText,{size:16,className:"text-sf-light-blue"}),"活動履歴（時系列）"]}),(0,t.jsx)("div",{className:"space-y-3",children:e.requests.map((e,s)=>(0,t.jsx)("div",{className:"bg-white rounded border border-sf-border p-3 hover:shadow-sm transition-shadow",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsxs)("div",{className:"flex-shrink-0 w-20 text-xs text-sf-text-weak",children:[(0,t.jsx)(n.Calendar,{size:14,className:"inline mr-1"}),e.日付]}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("span",{className:"text-xs font-medium text-sf-light-blue",children:e.行動内容}),e.面談者&&(0,t.jsxs)("span",{className:"text-xs text-sf-text-weak flex items-center gap-1",children:[(0,t.jsx)(c.User,{size:12}),e.面談者]})]}),e.商談内容&&(0,t.jsx)("p",{className:"text-xs text-sf-text mt-1 leading-relaxed",children:e.商談内容}),e.提案物&&(0,t.jsxs)("div",{className:"mt-2 text-xs",children:[(0,t.jsx)("span",{className:"text-sf-text-weak",children:"提案物: "}),(0,t.jsx)("span",{className:"text-sf-text",children:e.提案物})]}),e.次回プラン&&(0,t.jsxs)("div",{className:"mt-1 text-xs",children:[(0,t.jsx)("span",{className:"text-sf-text-weak",children:"次回: "}),(0,t.jsx)("span",{className:"text-sf-text",children:e.次回プラン})]})]})]})},s))})]})})})]},e.designNo)})})]})})]}),K&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-[60] p-4",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-5xl w-full max-h-[90vh] flex flex-col",children:[(0,t.jsxs)("div",{className:"p-4 border-b border-sf-border flex justify-between items-center bg-gray-50 rounded-t-lg",children:[(0,t.jsxs)("h3",{className:"font-bold text-lg text-sf-text flex items-center gap-2",children:[(0,t.jsx)(l.Search,{size:20,className:"text-pink-500"}),'検索結果: "',B,'" (',$.length,"件)"]}),(0,t.jsx)("button",{onClick:()=>W(!1),className:"text-gray-500 hover:text-gray-700 bg-gray-200 rounded-full p-1",children:(0,t.jsx)(g.X,{size:20})})]}),(0,t.jsx)("div",{className:"p-4 overflow-y-auto flex-1 bg-gray-100",children:$.length>0?(0,t.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:$.map((e,s)=>{let r=e.name.toLowerCase().endsWith(".pdf");return(0,t.jsxs)("div",{className:"group relative bg-white rounded border border-gray-200 overflow-hidden shadow-sm hover:shadow-md transition-shadow",children:[(0,t.jsx)("a",{href:(0,a.getImageUrl)(e.path),target:"_blank",rel:"noopener noreferrer",className:"block aspect-square overflow-hidden bg-gray-200 flex items-center justify-center",children:r?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center text-red-500",children:[(0,t.jsx)(o.FileText,{size:48}),(0,t.jsx)("span",{className:"text-xs font-bold mt-2 text-gray-500",children:"PDF"})]}):(0,t.jsx)("img",{src:(0,a.getImageUrl)(e.path),alt:e.name,className:"w-full h-full object-contain p-1 group-hover:scale-105 transition-transform duration-300",loading:"lazy"})}),(0,t.jsxs)("div",{className:"p-2 text-xs",children:[(0,t.jsx)("div",{className:"font-medium truncate text-sf-text",title:e.name,children:e.name}),(0,t.jsx)("div",{className:"text-gray-400 truncate mt-0.5",children:e.folder})]})]},s)})}):(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[(0,t.jsx)(l.Search,{size:48,className:"mb-4 text-gray-300"}),(0,t.jsx)("p",{children:"画像が見つかりませんでした"})]})})]})})]})}e.s(["default",()=>v])}]);