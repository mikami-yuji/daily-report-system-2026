# 営業日報システム - 使い方ガイド

## 🎯 概要
エクセルベースの営業日報を、モダンなWebインターフェースで管理できるシステムです。
既存のエクセルファイル（`.xlsm`）の関数やマクロを保持したまま、データの入力・閲覧・分析が可能です。

## 🏗️ システム構成

### バックエンド (Python + FastAPI)
- **場所**: `backend/main.py`
- **ポート**: `http://localhost:8000`
- **役割**: エクセルファイルの読み書きを担当

### フロントエンド (Next.js + React)
- **場所**: `frontend/`
- **ポート**: `http://localhost:3000`
- **役割**: ユーザーインターフェース

### データ保存先
- **ファイル**: `daily_report_template.xlsm`
- エクセルの関数やマクロはそのまま保持されます

## 🚀 起動方法

### 1. バックエンドの起動
```powershell
cd backend
py main.py
```
→ `http://0.0.0.0:8000` で起動します

### 2. フロントエンドの起動
```powershell
cd frontend
npm run dev
```
→ `http://localhost:3000` で起動します

### 3. ブラウザでアクセス
`http://localhost:3000` を開く

## 📋 機能

### 1. 日報一覧表示（トップページ）
- エクセルに保存されている全ての日報を一覧表示
- 日付、行動内容、エリア、訪問先、面談者、商談内容などを表示
- データは自動的にエクセルから読み込まれます

### 2. 新規日報入力（入力フォーム）
- 「＋ 新規入力」ボタンから入力画面へ
- 以下の項目を入力可能:
  - 日付 (必須)
  - 行動内容 (必須) - 訪問/電話/メール/その他
  - エリア
  - 得意先CD
  - 訪問先名 (必須)
  - 面談者
  - 滞在時間
  - 商談内容
  - 提案物
  - 次回プラン

- 「日報を登録」ボタンで保存
- データは自動的にエクセルファイルに追記されます

## 🎨 デザインの特徴
- **ダークモード**: 目に優しいダークテーマ
- **グラデーション**: 紫〜ピンクのモダンなグラデーション
- **ガラスモーフィズム**: 半透明の背景とぼかし効果
- **レスポンシブ**: PC・タブレット・スマホに対応

## 🔧 技術スタック

### バックエンド
- **FastAPI**: 高速なPython Webフレームワーク
- **pandas**: データ処理
- **openpyxl**: エクセルファイルの読み書き（VBAマクロ保持）
- **uvicorn**: ASGIサーバー

### フロントエンド
- **Next.js 16**: Reactフレームワーク
- **TypeScript**: 型安全な開発
- **Tailwind CSS**: ユーティリティファーストCSS

## 📝 今後の拡張予定

### Phase 3: 分析機能
- [ ] 月次訪問件数のグラフ化
- [ ] エリア別の活動分析
- [ ] 重点顧客の訪問履歴
- [ ] カレンダー形式での表示

### Phase 4: その他の機能
- [ ] 日報の編集機能
- [ ] 日報の削除機能
- [ ] 検索・フィルター機能
- [ ] CSVエクスポート
- [ ] PDF出力

## ⚠️ 注意事項
- エクセルファイルは自動的に上書き保存されます
- 複数人で同時に使用する場合は、ファイルロックに注意してください
- バックアップは定期的に取ることをお勧めします

## 🐛 トラブルシューティング

### エラー: "Failed to fetch"
- バックエンドが起動しているか確認してください
- `http://localhost:8000` にアクセスして、`{"message": "Daily Report API is running"}` が表示されるか確認

### エラー: "Excel file not found"
- `daily_report_template.xlsm` が正しい場所にあるか確認してください
- バックエンドの `main.py` から見て `../daily_report_template.xlsm` の位置にあるべきです

### データが表示されない
- ブラウザのコンソール（F12）でエラーを確認
- バックエンドのターミナルでエラーログを確認

## 📞 サポート
問題が発生した場合は、以下を確認してください:
1. Python 3.13がインストールされているか
2. Node.js 24.3.0がインストールされているか
3. 必要なパッケージがインストールされているか
   - バックエンド: `py -m pip install fastapi uvicorn pandas openpyxl`
   - フロントエンド: `npm install` (frontendフォルダ内で実行)
